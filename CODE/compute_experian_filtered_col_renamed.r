# -------------------------------------------------------------------------------- NOTEBOOK-CELL: CODE
library(dataiku)

# Recipe inputs
experian_by_bg <- dkuReadDataset("experian_by_bg")

# Compute recipe outputs from inputs
# TODO: Replace this part by your actual code that computes the output, as a R dataframe or data table
experian_filtered_col_renamed <- experian_by_bg # For this sample code, simply copy input to output

# -------------------------------------------------------------------------------- NOTEBOOK-CELL: CODE
library(dplyr)

# -------------------------------------------------------------------------------- NOTEBOOK-CELL: CODE
head(experian_filtered_col_renamed)

# -------------------------------------------------------------------------------- NOTEBOOK-CELL: CODE
test <- select(experian_filtered_col_renamed,  CYA04T18P , CYA04T21P , CYA04T55P , CYA04T65P , CYA16VV01 , MAXAGEVAL , CYA18VV01 , MINAGEVAL , CYEC14V001 , CYC13VV01 , PYCYPOPGRW , CYADULT18P , CYB26VV01 , CYB26VV02 , CYB26VV03 , CYPOPDENS , PYA04T18P , PYA04T21P , PYA04T55P , PYA04T65P , PYA16VV01 , PYA18VV01 , PYEC14V001 , PYEC17V001 , PYC13VV01 , TCX01V0981 , TCX01V0971 , TCOWNEXPEN , TCOTHLODGE , TCOWNDWELL , TCRNTDWELL , TCSHELTER , TFX01V0981 , TFX01V0971 , TFOWNEXPEN , TFOTHLODGE , TFOWNDWELL , TFRNTDWELL , TFSHELTER , ZIP__Coverage_Area , ZIP_Key , ZIP_Name , CYB17MED , CYB27VV01 , CYB30VV01 , XCYB01V002 , XCYB01V003 , PYB17MED , PYB27VV01 , PYB30VV01 , XPYB01V002 , XPYB01V003 , HOO00MEDN , RNT00MED , CDB17MED )

# -------------------------------------------------------------------------------- NOTEBOOK-CELL: CODE
head(test)

# -------------------------------------------------------------------------------- NOTEBOOK-CELL: CODE
colnames(test) <- c( "Basic Variables Current Year Estimates A (2018) Age Total (Pop) Age 18+ " , "Basic Variables Current Year Estimates A (2018) Age Total (Pop) Age 21+ " , "Basic Variables Current Year Estimates A (2018) Age Total (Pop) Age 55+ " , "Basic Variables Current Year Estimates A (2018) Age Total (Pop) Age 65+ " , "Basic Variables Current Year Estimates A (2018) Age Total (Pop) Average (Mean) Age, Total " , "Basic Variables Current Year Estimates A (2018) Age Total (Pop) Maximum Age Value " , "Basic Variables Current Year Estimates A (2018) Age Total (Pop) Median Age, Total " , "Basic Variables Current Year Estimates A (2018) Age Total (Pop) Minimum Age Value " , "Basic Variables Current Year Estimates A (2018) Income Household Average (Mean) Household Income " , "Basic Variables Current Year Estimates A (2018) Income Per Capita Income (based on Total Population) " , "Basic Variables Current Year Estimates A (2018) 5 Year Projected Population Growth " , "Basic Variables Current Year Estimates A (2018) Adult Population " , "Basic Variables Current Year Estimates A (2018) Average (Mean) Household Size " , "Basic Variables Current Year Estimates A (2018) Average (Mean) Household Size, Family Households " , "Basic Variables Current Year Estimates A (2018) Average (Mean) Household Size, Non-Family Households " , "Basic Variables Current Year Estimates A (2018) Population Density " , "Basic Variables Five Year Projections A (2023) Age Total (Pop) Age 18+ " , "Basic Variables Five Year Projections A (2023) Age Total (Pop) Age 21+ " , "Basic Variables Five Year Projections A (2023) Age Total (Pop) Age 55+ " , "Basic Variables Five Year Projections A (2023) Age Total (Pop) Age 65+ " , "Basic Variables Five Year Projections A (2023) Age Total (Pop) Average (Mean) Age, Total " , "Basic Variables Five Year Projections A (2023) Age Total (Pop) Median Age, Total " , "Basic Variables Five Year Projections A (2023) Income Household Average (Mean) Household Income " , "Basic Variables Five Year Projections A (2023) Income Household Median Household Income " , "Basic Variables Five Year Projections A (2023) Income Per Capita Income (based on Total Population) " , "Consumer Expenditure Current Year Estimates A (2018) Total Expenditure Housing Shelter Owned dwellings Maintenance, repairs, insurance, other expenses Total Maintenance and repair commodities owned dwellings " , "Consumer Expenditure Current Year Estimates A (2018) Total Expenditure Housing Shelter Owned dwellings Maintenance, repairs, insurance, other expenses Total Maintenance and repair services owned dwellings " , "Consumer Expenditure Current Year Estimates A (2018) Total Expenditure Housing Shelter Owned dwellings Total Maintenance, repairs, insurance, other expenses " , "Consumer Expenditure Current Year Estimates A (2018) Total Expenditure Housing Shelter Total Other lodging " , "Consumer Expenditure Current Year Estimates A (2018) Total Expenditure Housing Shelter Total Owned dwellings " , "Consumer Expenditure Current Year Estimates A (2018) Total Expenditure Housing Shelter Total Rented dwellings " , "Consumer Expenditure Current Year Estimates A (2018) Total Expenditure Housing Total Shelter " , "Consumer Expenditure Five Year Projections A (2023) Total Expenditure Housing Shelter Owned dwellings Maintenance, repairs, insurance, other expenses Total Maintenance and repair commodities owned dwellings " , "Consumer Expenditure Five Year Projections A (2023) Total Expenditure Housing Shelter Owned dwellings Maintenance, repairs, insurance, other expenses Total Maintenance and repair services owned dwellings " , "Consumer Expenditure Five Year Projections A (2023) Total Expenditure Housing Shelter Owned dwellings Total Maintenance, repairs, insurance, other expenses " , "Consumer Expenditure Five Year Projections A (2023) Total Expenditure Housing Shelter Total Other lodging " , "Consumer Expenditure Five Year Projections A (2023) Total Expenditure Housing Shelter Total Owned dwellings " , "Consumer Expenditure Five Year Projections A (2023) Total Expenditure Housing Shelter Total Rented dwellings " , "Consumer Expenditure Five Year Projections A (2023) Total Expenditure Housing Total Shelter " , "Geographic Identifiers Physically Within (2018) ZIP Code Coverage Area " , "Geographic Identifiers Physically Within (2018) ZIP Code Key " , "Geographic Identifiers Physically Within (2018) ZIP Code Name " , "Housing Units Current Year Estimates A (2018) Housing Value Median Housing Value " , "Housing Units Current Year Estimates A (2018) Length of Residence Average (Mean) Length of Residence " , "Housing Units Current Year Estimates A (2018) Year Structure Built (HU) Median Year Structure Built " , "Housing Units Current Year Estimates A (2018) % Housing Units: Occupied " , "Housing Units Current Year Estimates A (2018) % Housing Units: Vacant " , "Housing Units Five Year Projections A (2023) Housing Value Median Housing Value " , "Housing Units Five Year Projections A (2023) Length of Residence Average (Mean) Length of Residence " , "Housing Units Five Year Projections A (2023) Year Structure Built (HU) Median Year Structure Built " , "Housing Units Five Year Projections A (2023) % Housing Units: Occupied " , "Housing Units Five Year Projections A (2023) % Housing Units: Vacant " , "Housing Units US Census (2000) Housing Value Owner Occupied (HU) Housing Value Median " , "Housing Units US Census (2000) Rent (HU) Cash Rent Median Cash Rent " , "Housing Units US Census (2010) Housing Value Median Housing Value " )

# -------------------------------------------------------------------------------- NOTEBOOK-CELL: CODE
head(test)

# -------------------------------------------------------------------------------- NOTEBOOK-CELL: CODE
# Recipe outputs
dkuWriteDataset(test,"experian_filtered_col_renamed")
